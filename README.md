# php_pma_mysql_template
Шаблон представляет из себя заготовку под проект на PHP с возможностью перехода на Laravel.

Из дополнительных инструментов присутствует PhpMyAdmin

## Структура проекта:
```text

project/
├── app/                     # Корневая папка приложения
│   ├── public/              # Веб-доступная папка (корень для Nginx)
│   │   ├── index.php        # Точка входа приложения
│   │   ├── .htaccess        # Конфигурация Apache (если потребуется)
│   └── ...                  # Остальной код приложения
│
├── db_data/                 # Данные MySQL (создаются автоматически)
│
├── nginx/                   # Конфигурация и логи Nginx
│   ├── conf.d           
│   │   └── default.conf    # Основной конфигурационный файл Nginx
│   └── logs/                # Логи Nginx
│       ├── access.log       # Лог доступа
│       └── error.log        # Лог ошибок
│
├── docker-compose.yml       # Docker Compose конфигурация
│
└── README.md                # Документация проекта (по желанию)
```

### Пояснения
    app (PHP 8.3):
        Работает в режиме php-fpm.
        Монтируется локальная директория ./app как корень приложения.
        Этот сервис готов для работы как с ванильным PHP, так и для запуска Laravel в будущем.

    nginx:
        Использует кастомный конфигурационный файл nginx.conf, который нужно создать. Пример файла ниже.
        Слушает локальный порт 8080 для доступа через браузер.

    mysql:
        Сохраняет данные в локальный volume db_data.
        Настраиваются переменные среды для подключения.

    phpmyadmin:
        Подключается к базе данных через сервис mysql.
        Доступен по адресу http://localhost:8081.

## Шаги для запуска

Убедитесь, что у вас установлен Docker и Docker Compose.
Создайте директории и файлы:
    app/ — для исходного кода приложения.
    nginx/conf.d/default.conf — для конфигурации Nginx.
    nginx/logs/ — для логов Nginx.
Запустите команду:

```bash
docker-compose up -d
```


Доступ:
    Приложение: http://localhost:8080
    PhpMyAdmin: http://localhost:8081

## Переход на Laravel

Для Laravel достаточно:

Перенести исходный код в app/.
Убедиться, что директория public/ является корневой для Nginx.
Установить зависимости Laravel через composer. 
Можно добавить сервис для Composer в docker-compose.yml или использовать локальный.

Дополнительные рекомендации:

Для ванильного PHP:
Добавьте поддиректории, например views/ для шаблонов или src/ для модулей/функций, чтобы упорядочить проект.

Для Laravel:
Когда перейдёте на Laravel, вся структура приложения 
(например, routes/, app/, storage/) автоматически появится 
внутри папки app/. Убедитесь, что public/ остаётся корнем для веб-сервера.

## В случае ошибок

### Проверка монтирования

После запуска контейнеров проверьте, что папка public и её содержимое корректно смонтированы в контейнер:

1. Посмотреть файлы в PHP-контейнере:

```bash
docker exec -it php_app ls /var/www/html/public
```

2. Посмотреть файлы в Nginx-контейнере:

```bash
docker exec -it nginx_server ls /var/www/html/public
```

### Команды для запуска и проверки:

Пересоздайте контейнеры:

```bash
docker-compose down
docker-compose up --build -d
```

Проверьте, доступен ли index.php в браузере по адресу http://localhost:8080.

## Таблица базовых команд Docker Compose

| Команда                                     | Описание                                                   |
|---------------------------------------------|------------------------------------------------------------|
| `docker-compose up`                         | Запускает контейнеры, описанные в `docker-compose.yml` (по умолчанию в фоновом режиме). |
| `docker-compose up -d`                      | Запускает контейнеры в фоновом режиме (detached mode).      |
| `docker-compose down`                       | Останавливает и удаляет все контейнеры, сети и тома.        |
| `docker-compose build`                      | Пересобирает образы контейнеров (если изменены Dockerfile или конфигурации). |
| `docker-compose restart`                    | Перезапускает все контейнеры.                              |
| `docker-compose ps`                         | Показывает список контейнеров, запущенных с использованием Compose. |
| `docker-compose logs`                       | Показывает логи всех контейнеров, запущенных через Compose. |
| `docker-compose exec <service> <command>`    | Выполняет команду в работающем контейнере. Например: `docker-compose exec app bash`. |
| `docker-compose run <service> <command>`     | Запускает одноразовый контейнер для выполнения команды. Пример: `docker-compose run app php -v`. |
| `docker-compose stop`                       | Останавливает все запущенные контейнеры.                   |
| `docker-compose start`                      | Запускает остановленные контейнеры.                        |
| `docker-compose logs <service>`             | Показывает логи конкретного сервиса (например, `docker-compose logs nginx`). |
| `docker-compose pull`                       | Загружает образы контейнеров из реестра (например, Docker Hub). |
| `docker-compose push`                       | Загружает локальные образы в Docker Hub (или другой реестр). |
| `docker-compose config`                     | Показывает текущую конфигурацию Docker Compose, включая все переменные окружения. |
| `docker-compose rm`                         | Удаляет остановленные контейнеры.                          |
| `docker-compose ps -a`                      | Показывает список всех контейнеров, включая остановленные. |
| `docker-compose top`                        | Показывает процессы, работающие внутри контейнеров.         |
